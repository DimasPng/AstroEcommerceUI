---
import { Image } from 'astro:assets'
import { Icon } from 'astro-icon'

interface Props {
  products: object
}
const { products } = Astro.props

const sortedProducts = products.slice().sort((a, b) => {
  // Сначала шли хиты продаж в наличии
  if (a.hit && b.hit) {
    // Сравнение по количеству для хитов продаж
    return b.quantity - a.quantity
  } else if (a.hit && !b.hit) {
    // Перемещаем хит продаж вперед, даже если он не в наличии
    return -1
  } else if (!a.hit && b.hit) {
    // Перемещаем хит продаж вперед, даже если он не в наличии
    return 1
  }

  // Затем шли все остальные товары в наличии
  if (a.quantity > 0 && b.quantity > 0) {
    return b.quantity - a.quantity
  } else if (a.quantity > 0 && b.quantity <= 0) {
    // Перемещаем товар в наличии вперед
    return -1
  } else if (a.quantity <= 0 && b.quantity > 0) {
    // Перемещаем товар в наличии вперед
    return 1
  }

  // В конце идут все остальные товары
  return 0
})
---

<ul class="flex flex-wrap p-1">
  {
    products.map((product) => {
      return (
        <li class="w-2/4 p-2.5 border-r border-b">
          <a href={product.uri_product}>
            <Image
              src={product.images[0]}
              width="100"
              height="100"
              alt="Product 1"
              class="mb-2"
            />
          </a>
          <a href={product.uri_product}>
            <div class="leading-tight mb-1">{product.title}</div>
          </a>
          <div class="text-2xl font-semibold mb-1.5">
            {product.price}
            <span class="text-base">₴</span>
          </div>
        </li>
      )
    })
  }
</ul>
