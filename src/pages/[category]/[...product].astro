---
export const prerender = false;

import getData from '../../js/api/api.js'
import Footer from '../../components/general/footer/Footer.astro'
import CurrentProduct from '../../components/product_card/ProductCard.astro'
import Header from '../../components/general/header/Header.astro'
import LayoutProduct from '../../layouts/LayoutProduct.astro'
import { Category, Product } from '../../js/types.js'

// export async function getStaticPaths() {
//   const [all_categories, product] = await getData()
//   return product.map((prod) => {
//     return {
//       params: {
//         category: prod.category.uri_category,
//         product: prod.uri_product,
//       },
//       props: { prod, all_categories },
//     }
//   })
// }

// interface Props {
//   prod: Product
//   all_categories: Category[]
// }

// const { category, product } = Astro.params
// const { prod, all_categories } = Astro.props

const [all_categories, products] = await getData();

const { product } = Astro.params;

const prod = products.find((prod) => prod.uri_product === product);


---

<LayoutProduct product={prod}>
  <Header />
  <main class="flex-grow">
    <CurrentProduct product={prod} />
  </main>
  <Footer />
</LayoutProduct>
