---
import getData from '../../api/api.js'
import Footer from '../../components/general/Footer.astro'
import Product from '../../components/product_card/ProductCard.astro'
import Header from '../../components/general/header/Header.astro'
import LayoutProduct from '../../layouts/LayoutProduct.astro'

export async function getStaticPaths() {
  const [all_categories, product] = await getData()
  return product.map((prod) => {
    return {
      params: {
        category: prod.category.uri_category,
        product: prod.uri_product,
      },
      props: { prod, all_categories },
    }
  })
}

const { category, product } = Astro.params
const { prod, all_categories } = Astro.props
---

<LayoutProduct product={prod}>
  <Header />
  <main class="flex-grow">
    <Product product={prod} />
  </main>
  <Footer />
</LayoutProduct>
